var W=Object.defineProperty;var N=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var A=(t,a,e)=>a in t?W(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e,E=(t,a)=>{for(var e in a||(a={}))b.call(a,e)&&A(t,e,a[e]);if(N)for(var e of N(a))x.call(a,e)&&A(t,e,a[e]);return t};var I=(t,a,e)=>new Promise((_,d)=>{var v=r=>{try{l(e.next(r))}catch(u){d(u)}},k=r=>{try{l(e.throw(r))}catch(u){d(u)}},l=r=>r.done?_(r.value):Promise.resolve(r.value).then(v,k);l((e=e.apply(t,a)).next())});import{d as B,f as o,w as C,Z as D,a8 as F,a9 as O,_ as G,k as p,u as L,ab as P,m as h,A as R,ac as H}from"./vue-DhXvXWyK.js";import{B as K}from"./index-DVzcH--h.js";import{a as V,b as Z}from"./entry/index-BcidWyMC.js";import $ from"./Reading2-lCUqKg8u.js";import j from"./Listening2-Ae0yuu0y.js";import q from"./Writing2-TGI-TgfS.js";import z from"./Speaking2-BgTuL-qh.js";import{S as J,R as Q,L as X,W as Y,a as ee}from"./data-C-2nBY8q.js";import{c as ae}from"./exam-CAJo7aCX.js";import{ap as te}from"./antd-BFwNME3X.js";const re={key:0,class:"mb-2"},de=B({__name:"EditorHomeworkModal",props:{homeworkId:Number,titleEditor:{type:String}},setup(t){const a=t,{t:e}=V(),{createMessage:_,createErrorModal:d}=Z(),v={Reading:Q,Listening:X,Writing:Y,Speaking:ee},k=o(null),l=o(null),r=o(null),u=o(null),f=o(E({},v)),c=o(!1),i=o("reading"),y=o(!1),T=()=>I(this,null,function*(){if(!a.homeworkId){d({title:e("sys.api.errorTip"),content:e("sys.exception.anErrorOccured")});return}const n={reading:k,listening:l,writing:r,speaking:u}[i.value];n.value&&(c.value=!0,n.value.submitAll(a.homeworkId),c.value=!1)});function M(s){return I(this,null,function*(){try{c.value=!0;const n=yield ae(s);f.value=n;const w=["Reading","Listening","Writing","Speaking"].some(m=>{var g;return((g=n[m])==null?void 0:g.length)>0?(i.value=m.toLowerCase(),!0):!1});y.value=w}catch(n){_.error(e("sys.app.dataNotFound"))}finally{c.value=!1}})}return C(()=>a.homeworkId,s=>{s?M(s):f.value=E({},v)}),(s,n)=>(D(),F(L(K),H(s.$attrs,{title:t.titleEditor,"default-fullscreen":"","can-fullscreen":!1,loading:c.value,onOk:T}),{default:O(()=>{var w,m,g,S;return[y.value?P("",!0):(D(),G("div",re,[p(L(te),{value:i.value,"onUpdate:value":n[0]||(n[0]=U=>i.value=U),options:L(J)},null,8,["value","options"])])),h(p($,{ref_key:"readingRef",ref:k,value:(w=f.value)==null?void 0:w.Reading,"is-homework":!0},null,8,["value"]),[[R,i.value==="reading"]]),h(p(j,{ref_key:"listeningRef",ref:l,value:(m=f.value)==null?void 0:m.Listening,"is-homework":!0},null,8,["value"]),[[R,i.value==="listening"]]),h(p(q,{ref_key:"writingRef",ref:r,value:(g=f.value)==null?void 0:g.Writing,"is-homework":!0},null,8,["value"]),[[R,i.value==="writing"]]),h(p(z,{ref_key:"speakingRef",ref:u,value:(S=f.value)==null?void 0:S.Speaking,"is-homework":!0},null,8,["value"]),[[R,i.value==="speaking"]])]}),_:1},16,["title","loading"]))}});export{de as _};
