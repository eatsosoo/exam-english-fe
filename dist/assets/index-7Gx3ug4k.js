var T=(x,e,o)=>new Promise((w,g)=>{var M=a=>{try{m(o.next(a))}catch(t){g(t)}},b=a=>{try{m(o.throw(a))}catch(t){g(t)}},m=a=>a.done?w(a.value):Promise.resolve(a.value).then(M,b);m((o=o.apply(x,e)).next())});import{_ as z}from"./BasicTable.vue_vue_type_script_setup_true_lang-wYzSQTfH.js";import"./TableImg.vue_vue_type_style_index_0_lang-D3F4T3v_.js";import"./index-BKjGR123.js";import{u as W}from"./useTable-CjgbZnnJ.js";import{getClassColumns as G,getFormSearchClassConfig as K}from"./tableData-BTxkGeqt.js";import{u as O,_ as V,a as U,b as Z}from"./entry/index-BcidWyMC.js";import{_ as j}from"./DetailClassModal.vue_vue_type_script_setup_true_lang-BvFt0TqU.js";import{u as $}from"./index-DVzcH--h.js";import{_ as q}from"./AddStudentModal.vue_vue_type_script_setup_true_lang-Cq8BlZMd.js";import{c as H,a as J}from"./class-6s197Rj_.js";import{d as P,f as A,c as Q,a7 as X,Z as u,_ as d,k as l,a9 as y,G as p,a0 as k,u as f,F as S,ab as v}from"./vue-DhXvXWyK.js";import"./BasicForm.vue_vue_type_script_setup_true_lang-DbX2m63q.js";import"./FormItem.vue_vue_type_script_lang-BQsfJt-d.js";import"./componentMap-BjYe58Mw.js";import"./useFormItem-oxzr_Srp.js";import"./antd-BFwNME3X.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-DFfZeCIC.js";import"./index-BQqLbfF_.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-D_32YSSg.js";import"./copyTextToClipboard-DJj00FMq.js";import"./index-BH-x8rO3.js";import"./index-BO5ERYHo.js";import"./base64Conver-bBv-IO2K.js";import"./helper-JLwI6lBn.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BL3smh9L.js";import"./useForm-CX4sdfhA.js";import"./uuid-D0SLUWHI.js";import"./sortable.esm-CoO8jRpa.js";import"./onMountedOrActivated-CvY6VkYA.js";import"./useWindowSizeFn-SAmktNkd.js";import"./useSortable-Chl02yjp.js";import"./download-C8Z1CAz1.js";import"./exam-CAJo7aCX.js";import"./student-DuYQ3A9a.js";const Ee=P({__name:"index",setup(x){const{t:e}=U(),o=O(),[w,{openModal:g}]=$(),[M,{openModal:b}]=$(),[m,{getForm:a}]=W({title:e("routes.page.classroomList"),api:H(),columns:G(),useSearchForm:!0,formConfig:K(),showTableSetting:!0,tableSetting:{fullScreen:!0},showIndexColumn:!1,rowKey:"id",showSelectionBar:!1,actionColumn:{title:e("table.action"),dataIndex:"action"}}),t=A(null),h=A(!1),D=Q(()=>t.value?`${t.value.title} - ${t.value.teacher}`:""),{createSuccessModal:E,createErrorModal:F}=Z();function R(){}function I(n,s){o.setClassId(n.id),s==="VIEW"?(t.value=n,g()):b()}function B(n){return T(this,null,function*(){try{if(!o.getClassId){F({title:e("sys.api.errorTip"),content:e("sys.exception.anErrorOccured")});return}h.value=!0;const s={class_id:o.getClassId,students:n};(yield J(s))&&E({title:e("layout.setting.operatingTitle"),content:e("table.addStudentToClassSuccess")})}catch(s){const r=s.response.data.message;F({title:e("sys.api.errorTip"),content:r||s.message||e("sys.api.networkExceptionMsg")})}finally{h.value=!1}})}function L(n,s){const r=new Date,c=new Date(n),_=new Date(s);return r<c?e("form.newClassForm.pending"):r>=c&&r<=_?e("form.newClassForm.enable"):e("form.newClassForm.finished")}return(n,s)=>{var c,_;const r=X("a-button");return u(),d("div",null,[l(f(z),{onRegister:f(m)},{"form-custom":y(()=>[p(" custom-slot ")]),toolbar:y(()=>[l(r,{type:"primary",onClick:R},{default:y(()=>[p(k(f(e)("table.enterData")),1)]),_:1})]),bodyCell:y(({column:C,record:i})=>[C.key==="start_date"?(u(),d(S,{key:0},[p(k(i.start_date.split(" ")[0]),1)],64)):v("",!0),C.key==="end_date"?(u(),d(S,{key:1},[p(k(i.end_date.split(" ")[0]),1)],64)):v("",!0),C.key==="status"?(u(),d(S,{key:2},[p(k(L(i.start_date,i.end_date)),1)],64)):v("",!0),C.key==="action"?(u(),d(S,{key:3},[l(V,{size:20,icon:"ant-design:ordered-list-outlined",class:"mr-2 cursor-pointer",onClick:N=>I(i,"VIEW")},null,8,["onClick"]),l(V,{size:20,icon:"ant-design:user-add-outlined",class:"cursor-pointer",onClick:N=>I(i,"ADD")},null,8,["onClick"])],64)):v("",!0)]),_:1},8,["onRegister"]),l(j,{title:D.value,"class-id":(_=(c=t.value)==null?void 0:c.id)!=null?_:0,onRegister:f(w)},null,8,["title","class-id","onRegister"]),l(q,{title:D.value,loading:h.value,onRegister:f(M),onSelectStudents:B},null,8,["title","loading","onRegister"])])}}});export{Ee as default};
