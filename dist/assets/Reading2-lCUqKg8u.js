var z=Object.defineProperty;var R=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var V=(r,o,e)=>o in r?z(r,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[o]=e,w=(r,o)=>{for(var e in o||(o={}))Z.call(o,e)&&V(r,e,o[e]);if(R)for(var e of R(o))J.call(o,e)&&V(r,e,o[e]);return r};var E=(r,o,e)=>new Promise((C,d)=>{var m=f=>{try{y(e.next(f))}catch(c){d(c)}},t=f=>{try{y(e.throw(f))}catch(c){d(c)}},y=f=>f.done?C(f.value):Promise.resolve(f.value).then(m,t);y((e=e.apply(r,o)).next())});import{T as O}from"./index-C3lnRWnE.js";import{c as W,a as X,b as Y,d as ee}from"./entry/index-BcidWyMC.js";import{R as $}from"./data-C-2nBY8q.js";import{_ as te}from"./Question.vue_vue_type_script_setup_true_lang-CiV2iraA.js";import{d as ae}from"./exam-CAJo7aCX.js";import{R as U,ab as oe,aa as B}from"./antd-BFwNME3X.js";import{d as se,f as k,c as ne,w as le,a7 as ue,Z as v,_ as g,k as b,ad as re,a9 as _,G as M,a0 as q,u as p,F as N,aa as P,a8 as A,$ as x,a1 as ce,ab as ie}from"./vue-DhXvXWyK.js";import"./uuid-D0SLUWHI.js";import"./onMountedOrActivated-CvY6VkYA.js";const de={class:"bg-white px-2 mb-8"},me={class:"p-4 re-box-shadow rounded-lg"},fe={class:"re-box-shadow rounded-lg pa-4 w-full"},pe={key:1},ve={class:"flex flex-col gap-2 ml-4"},_e=["onClick"],ye=se({__name:"Reading2",props:{value:{type:Array,default:$},isHomework:{type:Boolean,default:!1}},setup(r,{expose:o}){const e=r,C=U.TabPane,d=k(0),m=k(e.value[0].questions[0]),t=k(e.value),y=k(!1),f=ne(()=>Array.from({length:t.value.length},(l,u)=>({key:u,tab:`Part ${u+1}`}))),{t:c}=X(),{createMessage:j,createErrorModal:F,createSuccessModal:D}=Y(),{prefixCls:S}=W("register");function I(l,u){const s=t.value[l].questions.findIndex(a=>{var n;return a.question_no===((n=m.value)==null?void 0:n.question_no)});s!==-1&&(t.value[l].questions[s]=u),j.success(c("common.updateSuccess"))}function K(l){const u=t.value[l].questions,s=u.at(-1),a=s?s.question_no+1:1;u.push({question_no:a,content:"",type:"choice",options:["A","B"].map(n=>({id:n,text:n})),answer:null})}function Q(l){t.value[d.value]=l}function G(){t.value.push(w({},$[0]))}function H(){m.value=t.value[d.value].questions[0]}function L(l){return E(this,null,function*(){var u;try{y.value=!0;const{subject:s,questions:a,id:n}=t.value[d.value],i={id:n||null,exam_id:l,type:"Reading",subject:s,questions:a,duration:500,media:null,questions_count:a.length},h=yield ae(i);h&&(D({title:c("form.exam.editSkill",{skill:"Reading"}),content:c("common.createSuccessfully"),getContainer:()=>document.body.querySelector(`.${S}`)||document.body}),Q(h.items))}catch(s){if(s.errorFields)return;const a=(u=s.response)==null?void 0:u.data.message;F({title:c("sys.api.errorTip"),content:a||s.message||c("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${S}`)||document.body})}finally{y.value=!1}})}return le(()=>e.value,l=>{t.value=l.length===0?$:l,m.value=t.value[0].questions[0],d.value=0}),o({submitAll:L}),(l,u)=>{const s=ue("a-button");return v(),g("div",de,[b(p(U),{activeKey:d.value,"onUpdate:activeKey":u[0]||(u[0]=a=>d.value=a),onChange:H},re({default:_(()=>[(v(!0),g(N,null,P(f.value,(a,n)=>(v(),A(p(C),{key:a.key,tab:a.tab},{default:_(()=>[b(p(oe),{gutter:[16,16]},{default:_(()=>[b(p(B),{span:12},{default:_(()=>[x("div",me,[x("h3",null,q(p(c)("common.readingContext")),1),b(p(O),{modelValue:t.value[n].subject,"onUpdate:modelValue":i=>t.value[n].subject=i,height:550},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024),b(p(B),{span:12,class:"flex"},{default:_(()=>[x("div",fe,[m.value?(v(),A(te,{key:0,value:m.value,"onUpdate:value":i=>I(n,i)},null,8,["value","onUpdate:value"])):(v(),g("h3",pe,q(`${p(c)("common.pleaseSelectQuestion")} ${a.tab}`),1))]),x("div",ve,[(v(!0),g(N,null,P(t.value[n].questions,(i,h)=>{var T;return v(),g("div",{key:`${a.key}_${h}`,class:ce(["border rounded-full h-10 w-10 flex items-center justify-center cursor-pointer",((T=m.value)==null?void 0:T.question_no)===i.question_no?"border-blue text-blue":"border-gray text-gray"]),onClick:be=>m.value=w({},i)},q(i.question_no),11,_e)}),128)),t.value[n].questions.length<13?(v(),A(s,{key:0,class:"border rounded-full h-10 w-10 flex items-center justify-center cursor-pointer",onClick:i=>K(n)},{default:_(()=>[M("+")]),_:2},1032,["onClick"])):ie("",!0)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["tab"]))),128))]),_:2},[t.value.length<3&&!r.isHomework?{name:"rightExtra",fn:_(()=>[b(s,{type:"default",onClick:G},{default:_(()=>[M(q(p(c)("common.add"))+" Part",1)]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}}),Te=ee(ye,[["__scopeId","data-v-9b786aa5"]]);export{Te as default};
